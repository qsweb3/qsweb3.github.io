<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Etherhide Explained: The Rise of Blockchain-Based Command and Control | QSWeb3's Technical Blog</title><meta name="author" content="QSWeb3"><meta name="copyright" content="QSWeb3"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="深入解析 EtherHide（區塊鏈智能合約作為 C2）技術、真實攻擊案例與 CTF 解題流程；含 pyinstaller 逆向、eth_call 與 BSC&#x2F;SePolia 查核實務。">
<meta property="og:type" content="article">
<meta property="og:title" content="Etherhide Explained: The Rise of Blockchain-Based Command and Control">
<meta property="og:url" content="https://qsweb3.com/etherhide-blockchain-cnc/index.html">
<meta property="og:site_name" content="QSWeb3&#39;s Technical Blog">
<meta property="og:description" content="深入解析 EtherHide（區塊鏈智能合約作為 C2）技術、真實攻擊案例與 CTF 解題流程；含 pyinstaller 逆向、eth_call 與 BSC&#x2F;SePolia 查核實務。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/qsweb3/post-cover-img/refs/heads/main/coverEtherHide.png">
<meta property="article:published_time" content="2025-10-16T09:31:29.000Z">
<meta property="article:modified_time" content="2025-10-22T03:54:36.151Z">
<meta property="article:author" content="QSWeb3">
<meta property="article:tag" content="BlockChain">
<meta property="article:tag" content="Web3">
<meta property="article:tag" content="EtherHide">
<meta property="article:tag" content="c2">
<meta property="article:tag" content="BSC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/qsweb3/post-cover-img/refs/heads/main/coverEtherHide.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Etherhide Explained: The Rise of Blockchain-Based Command and Control",
  "url": "https://qsweb3.com/etherhide-blockchain-cnc/",
  "image": "https://raw.githubusercontent.com/qsweb3/post-cover-img/refs/heads/main/coverEtherHide.png",
  "datePublished": "2025-10-16T09:31:29.000Z",
  "dateModified": "2025-10-22T03:54:36.151Z",
  "author": [
    {
      "@type": "Person",
      "name": "QSWeb3",
      "url": "https://qsweb3.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon_img.png"><link rel="canonical" href="https://qsweb3.com/etherhide-blockchain-cnc/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-7488705562481381',
  enable_page_level_ads: 'true'
});</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-6YSEMCKPN1"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-6YSEMCKPN1')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-6YSEMCKPN1', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Etherhide Explained: The Rise of Blockchain-Based Command and Control',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background: linear-gradient(to top, rgb(5, 5, 24), rgb(15, 58, 128), rgb(90, 43, 153), rgb(30, 15, 58));;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar_img.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Web3/"><i class="fa-fw fas fa-bitcoin-sign"></i><span> Web3</span></a></li><li><a class="site-page child" href="/categories/Cybersecurity/"><i class="fa-fw fas fa-shield"></i><span> Cybersecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://raw.githubusercontent.com/qsweb3/post-cover-img/refs/heads/main/coverEtherHide.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">QSWeb3's Technical Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Etherhide Explained: The Rise of Blockchain-Based Command and Control</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Web3/"><i class="fa-fw fas fa-bitcoin-sign"></i><span> Web3</span></a></li><li><a class="site-page child" href="/categories/Cybersecurity/"><i class="fa-fw fas fa-shield"></i><span> Cybersecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Etherhide Explained: The Rise of Blockchain-Based Command and Control</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-10-16T09:31:29.000Z" title="Created 2025-10-16 09:31:29">2025-10-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-22T03:54:36.151Z" title="Updated 2025-10-22 03:54:36">2025-10-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8D%80%E5%A1%8A%E9%8F%88%E6%8A%80%E8%A1%93%E7%A0%94%E7%A9%B6/">區塊鏈技術研究</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>8mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote>
<p><strong>TL;DR</strong>：EtherHide（或 EtherHiding）是把惡意 payload 託管在智能合約上、並用 <code>eth_call</code> 等方法讀取的 C2 技術。本文含 2025 年實戰案例（SePolia&#x2F;BSC）、CTF 解題與 pyinstaller 逆向步驟，並整理偵測與追蹤建議。</p>
</blockquote>
<span id="more"></span>

<p><span style="color:#FF0000;">本文有將一些專有名詞介紹在最底下，有看不懂得可以先到最底下瀏覽</span></p>
<h1 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h1><p>分析惡意程式建立威脅情資報告，我們總在追查攻擊者的位置</p>
<p>攻擊者也不斷改變 c2 的隱藏方式和建立方式</p>
<p>底下列出一些過去到現在看到的 c2 建立方式和傳資料方式：</p>
<ul>
<li>VPS</li>
<li>web hosting</li>
<li>Pastebin</li>
<li>Twitter</li>
<li>Github &#x2F; Gitee </li>
<li>Telegram</li>
<li>Google Calendar</li>
</ul>
<p>本文探討的是 EtherHide 技術，這是一種使用智能合約作為 C2 的技術</p>
<h2 id="什麼是-EtherHide"><a href="#什麼是-EtherHide" class="headerlink" title="什麼是 EtherHide"></a>什麼是 EtherHide</h2><p>EtherHide 是將任何 payload 插入到區塊鏈上的智能合約，之後透過外部呼叫並執行</p>
<p>因為區塊鏈的特性，所以插入的 payload 不會被刪除，可以被穩定的使用</p>
<p>且因為 EtherHide 使用區塊鏈網路作為 c2 infra ，所以現有的追蹤方式比較難應用到這部分</p>
<p>這裡摘要 EtherHide 相關資訊</p>
<ul>
<li>EtherHide 最早出現於 2023 年 10 月 [2]<ul>
<li>過去駭客是入侵智能合約進行竊盜，現在是利用合約合法的託管惡意程式</li>
</ul>
</li>
<li>雖然名字有 <code>Ether</code> ，但他不是專用於以太坊，此技術適用於各種智能合約平台</li>
<li>攻擊者使用 EtherHide 技術的好處<ul>
<li>區塊鏈的匿名性：追蹤攻擊者變得困難</li>
<li>區塊鏈的不可逆性：惡意程式將永遠保存在鏈上，無法被刪除</li>
<li>區塊鏈的去中心化：政府無法發布通知要求網站將上面的檔案刪除，也難以封鎖特定 ip</li>
<li>無須在受害者電腦存放大量惡意程式檔案，降低被偵測到的風險</li>
</ul>
</li>
</ul>
<h2 id="EtherHide-如何運作"><a href="#EtherHide-如何運作" class="headerlink" title="EtherHide 如何運作"></a>EtherHide 如何運作</h2><p>EtherHide 是透過將惡意程式以智能合約的方式去託管到區塊鏈上</p>
<p>所以可能的攻擊利用方式:</p>
<ul>
<li>攻擊者入侵有漏洞的網站 (常見使用過時 plugin 的 wordpress 網站)，在網站中嵌入 <code>javascript</code> 程式碼，該 <code>javascript</code> 程式碼會透過比如幣安的 SDK 和智能合約互動，以此獲取惡意的 payload</li>
</ul>
<p>幣安智能鏈（BSC, Binance Smart Chain）上的 <code>eth_call</code> 方法常見用於獲取惡意程式碼，<br>而不會在交易的 log 中留下痕跡 [3]</p>
<p>以下會介紹目前看到網路文章探討的真實世界案例以及 CTF 上面看到的題目</p>
<h1 id="CTF-競賽"><a href="#CTF-競賽" class="headerlink" title="CTF 競賽"></a>CTF 競賽</h1><h2 id="2025-07-13-資安菁英實戰培育課程－第二期臺北場-網路威脅防禦競賽"><a href="#2025-07-13-資安菁英實戰培育課程－第二期臺北場-網路威脅防禦競賽" class="headerlink" title="2025.07.13 - 資安菁英實戰培育課程－第二期臺北場: 網路威脅防禦競賽"></a>2025.07.13 - 資安菁英實戰培育課程－第二期臺北場: 網路威脅防禦競賽</h2><p><a target="_blank" rel="noopener" href="https://www.nics.nat.gov.tw/latest_news/announcements/Event_Information/09cbaeff-7774-4f20-9e43-1d2756e29af2/">課程介紹</a></p>
<h3 id="題目簡介"><a href="#題目簡介" class="headerlink" title="題目簡介"></a>題目簡介</h3><p>競賽題目裡面，有一個題目，題目給了一個 <code>qcow2</code> 檔案，<br>說是一個被駭客攻擊後，dump 出來的虛擬磁碟映像檔案</p>
<p>題目要求我們要找到駭客的 c2 ，並知道駭客傳遞的內容是什麼</p>
<h3 id="解題分享"><a href="#解題分享" class="headerlink" title="解題分享"></a>解題分享</h3><h4 id="找尋惡意程式在哪"><a href="#找尋惡意程式在哪" class="headerlink" title="找尋惡意程式在哪"></a>找尋惡意程式在哪</h4><p>首先掛載 qcow2</p>
<p>掛載方式為:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo modprobe nbd max_part=8</span><br><span class="line"></span><br><span class="line">qemu-nbd -c /dev/nbd1 file.qcow2</span><br><span class="line"></span><br><span class="line">sudo mkdir -p /mnt/nbd1p2</span><br><span class="line"></span><br><span class="line">sudo mount -o ro /dev/nbd1p2 /mnt/nbd1p2</span><br></pre></td></tr></table></figure>

<p>上面的做法是</p>
<ol>
<li>載入 nbd module</li>
<li>掛載 qcow2 到 nbd devices</li>
<li>將裡面的檔案系統掛載到 &#x2F;mnt&#x2F;nbd1p2</li>
</ol>
<p>掛載好之後，因為他是 windows 系統，想先看一下 event log</p>
<p>這裡使用一個 github 工具: <a target="_blank" rel="noopener" href="https://github.com/WithSecureLabs/chainsaw">chainsaw</a></p>
<p>這個工具可以分析 evtx ，並搜尋特定的事件</p>
<p>常見使用的 event code 為底下表格所列</p>
<table>
<thead>
<tr>
<th>Event Type</th>
<th>Event ID</th>
</tr>
</thead>
<tbody><tr>
<td>Process Creation (Sysmon)</td>
<td>1</td>
</tr>
<tr>
<td>Network Connections (Sysmon)</td>
<td>3</td>
</tr>
<tr>
<td>Image Loads (Sysmon)</td>
<td>7</td>
</tr>
<tr>
<td>File Creation (Sysmon)</td>
<td>11</td>
</tr>
<tr>
<td>Registry Events (Sysmon)</td>
<td>13</td>
</tr>
<tr>
<td>Powershell Script Blocks</td>
<td>4104</td>
</tr>
<tr>
<td>Process Creation</td>
<td>4688</td>
</tr>
<tr>
<td>Scheduled Task Creation</td>
<td>4698</td>
</tr>
<tr>
<td>Service Creation</td>
<td>7045</td>
</tr>
</tbody></table>
<p>這裡找尋 powershell 的事件 (4104)</p>
<p>所以使用底下指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./chainsaw search -t &#x27;Event.System.EventID: =4104&#x27; evtx_arrack_samples/&#x27;</span><br></pre></td></tr></table></figure>

<p>會看到底下被混淆的 powershell 指令</p>
<img src="/etherhide-blockchain-cnc/1.png" class="" title="powershell malicious">

<p>把上面的解混淆就可以看到底下內容</p>
<img src="/etherhide-blockchain-cnc/2.png" class="" title="powershell malicious">

<p>上圖可以得到的資訊是</p>
<ol>
<li>第一階段的 c2 是 <code>ao[.]pe</code></li>
<li>持久化位置在 start up 資料夾底下</li>
</ol>
<p>之後我們到上述的資料夾就能看到惡意程式，這裡紀錄一下他的 hash</p>
<ul>
<li>MD5: 561b6768046839520f6912c9c7a2f445</li>
</ul>
<p>這個有在 VirusTotal 上面，所以有興趣的人可以自行下載來看</p>
<h4 id="分析惡意程式"><a href="#分析惡意程式" class="headerlink" title="分析惡意程式"></a>分析惡意程式</h4><p>在 VirusTotal 上面瀏覽可以看到有連線到<strong>Sepolia 測試網</strong></p>
<img src="/etherhide-blockchain-cnc/3.png" class="" title="sepolia network">


<p>底下 <code>any.run</code> 上可以知道這個惡意程式是透過 pyinstaller 打包成 windows 執行檔案</p>
<img src="/etherhide-blockchain-cnc/4.png" class="" title="pyinstaller">

<p>逆向的方式為</p>
<ol>
<li>將 pyinstaller 打包的檔案轉回 <code>pyc</code> 檔案</li>
<li>將 python byte code 轉回 python source code</li>
</ol>
<p>解 pyinstaller 檔案我用<a target="_blank" rel="noopener" href="https://pyinstxtractor-web.netlify.app/">這個網站</a>解</p>
<p>會得到底下一堆檔案，理論上主程式會跟程式檔案名稱相同，所以應該是 <code>c2.pyc</code></p>
<img src="/etherhide-blockchain-cnc/5.png" class="" title="c2.pyc">

<p>python byte code 轉回 python 的 source code 我使用<a target="_blank" rel="noopener" href="https://pylingual.io/">這個網站</a>解</p>
<p>底下截一小部分的惡意程式的程式片段</p>
<img src="/etherhide-blockchain-cnc/6.png" class="" title="code">

<img src="/etherhide-blockchain-cnc/7.png" class="" title="code">

<p>根據上述的線索，可以到這個<a target="_blank" rel="noopener" href="https://sepolia.etherscan.io/address/0x9686e522DBf2300aBc627a12d6c6b8E0AC8f02Fb">網址</a>進行查詢</p>
<img src="/etherhide-blockchain-cnc/8.png" class="" title="sepolia">

<p>上圖可以看到他的交易資料是一串 hex 資料，我們把它解密後就能知道駭客透過區塊鏈作為 c2 傳遞的內容</p>
<img src="/etherhide-blockchain-cnc/9.png" class="" title="decode hex data">

<h2 id="Hackcon2018-CTF-EtherHide"><a href="#Hackcon2018-CTF-EtherHide" class="headerlink" title="Hackcon2018 CTF - EtherHide"></a>Hackcon2018 CTF - EtherHide</h2><h3 id="題目簡介-1"><a href="#題目簡介-1" class="headerlink" title="題目簡介"></a>題目簡介</h3><img src="/etherhide-blockchain-cnc/10.png" class="" title="intro problem">

<h3 id="解題分享-1"><a href="#解題分享-1" class="headerlink" title="解題分享"></a>解題分享</h3><p><span style="color:#FF0000;">Ropsten Test Network 已經於 2022 年 10 月被宣告停用，目前平台基本沒支援該測試網路的資料了</span></p>
<p><span style="color:#FF0000;"> 底下內容純紀錄此 <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=dhr_p1A3OAU">Youtube 影片的片段畫面</a> </span></p>
<p>從題目的敘述可以知道 2 個資訊：</p>
<ol>
<li>network: <code>Ropsten Test Network</code></li>
<li>Address: <code>0x94f23F189583e828E73573905A19d93E21D0E957</code></li>
</ol>
<p>只要上去區塊鏈瀏覽的相關平台找該地址的資料，就會看到它的歷史交易資料，裡面就會有答案</p>
<p>過去的查詢網址：<a target="_blank" rel="noopener" href="https://ropsten.etherscan.io/">https://ropsten.etherscan.io/</a> (<span style="color:#FF0000;">目前已經被棄用</span>)</p>
<p>下圖取自 <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=dhr_p1A3OAU">youtube</a> ，也就是查詢該地址的一個交易紀錄</p>
<img src="/etherhide-blockchain-cnc/11.png" class="" title="intro problem">

<p>將上圖的 hex decode 就能看到答案，也就是下圖</p>
<img src="/etherhide-blockchain-cnc/12.png" class="" title="flag">
<p>取自 <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=dhr_p1A3OAU">youtube</a></p>
<h1 id="網路文章彙整整理"><a href="#網路文章彙整整理" class="headerlink" title="網路文章彙整整理"></a>網路文章彙整整理</h1><h2 id="2025-10-01-Investigating-a-ClearFake-ClickFix-Etherhide-campaign"><a href="#2025-10-01-Investigating-a-ClearFake-ClickFix-Etherhide-campaign" class="headerlink" title="2025.10.01 - Investigating a ClearFake&#x2F;ClickFix + Etherhide campaign"></a>2025.10.01 - Investigating a ClearFake&#x2F;ClickFix + Etherhide campaign</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.atea.no/siste-nytt/it-sikkerhet/investigating-a-clearfake-clickfix-etherhide-campaign/">參考文章連結</a></p>
</blockquote>
<p>這篇文章講述的是 ClearFake + EtherHide</p>
<p>整個攻擊流程為</p>
<ol>
<li>在受感染的 wordpress 植入惡意的 javascript</li>
<li>當受害者瀏覽網站，會執行惡意的 JavaScript 並連接和執行儲存在 BSC 的惡意指令</li>
<li>最終部署 Lumma (一種資料竊取的惡意程式)</li>
</ol>
<p>此次事件使用的 address: <code>0x7d0b5A06F8c43011fB66Eb90f61525A827eaE0d7</code></p>
<p>可以在<a target="_blank" rel="noopener" href="https://testnet.bscscan.com/address/0x7d0b5A06F8c43011fB66Eb90f61525A827eaE0d7">BscScan網站</a>瀏覽歷史交易資料</p>
<img src="/etherhide-blockchain-cnc/13.png" class="" title="search malicious address use BSCScan">


<h2 id="2025-04-22-Detecting-Fake-CAPTCHA-Campaigns-ClickFix-ClearFake-and-Etherhide"><a href="#2025-04-22-Detecting-Fake-CAPTCHA-Campaigns-ClickFix-ClearFake-and-Etherhide" class="headerlink" title="2025.04.22 - Detecting Fake CAPTCHA Campaigns: ClickFix, ClearFake, and Etherhide"></a>2025.04.22 - Detecting Fake CAPTCHA Campaigns: ClickFix, ClearFake, and Etherhide</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.thecyber.dad/p/detecting-fake-captcha-campaigns">參考文章連結</a></p>
</blockquote>
<p>這一篇談論到 ClearFake 搭配 EtherHide</p>
<p>裡面是各種資料參雜在一起，跟 EtherHide 有關的主要為底下 2 點：</p>
<ol>
<li>觀察到 powershell&#x2F;mshta 惡意指令鑲嵌到 BSC 智能合約上</li>
<li>此篇文章這部分敘述應是參考 <a target="_blank" rel="noopener" href="https://www.atea.no/siste-nytt/it-sikkerhet/investigating-a-clearfake-clickfix-etherhide-campaign/">Atea report</a></li>
</ol>
<h2 id="2025-01-02-EtherHiding-and-ClickFix-new-mask-of-social-engineering-campaign"><a href="#2025-01-02-EtherHiding-and-ClickFix-new-mask-of-social-engineering-campaign" class="headerlink" title="2025.01.02 - EtherHiding and ClickFix: new mask of social engineering campaign"></a>2025.01.02 - EtherHiding and ClickFix: new mask of social engineering campaign</h2><p><span style="color:#FF0000;">這篇文章分析寫得很詳細，值得好好閱讀</span></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://security.szustak.pl/etherhide/etherhide.html">參考文章連結</a></p>
</blockquote>
<p>這篇文章描述的攻擊事件流程為</p>
<ol>
<li>在受感染的 wordpress 網站植入惡意 javascript 程式碼 </li>
<li>受害者瀏覽受感染網站會執行惡意程式碼，並連接到 BSC 上面</li>
</ol>
<p>此事件的惡意 address: <code>0x9179dda8B285040Bf381AABb8a1f4a1b8c37Ed53</code></p>
<p>可以在 <a target="_blank" rel="noopener" href="https://testnet.bscscan.com/">bscscan 網站</a>上面瀏覽這個事件的合約</p>
<h2 id="2024-12-05-ClearFake-Campaigns-Trick-Users-Into-Copying-and-Executing-Powershell-Code"><a href="#2024-12-05-ClearFake-Campaigns-Trick-Users-Into-Copying-and-Executing-Powershell-Code" class="headerlink" title="2024.12.05 - ClearFake Campaigns Trick Users Into Copying and Executing Powershell Code"></a>2024.12.05 - ClearFake Campaigns Trick Users Into Copying and Executing Powershell Code</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.packetlabs.net/posts/clearfake-campaigns-trick-users-into-copying-and-executing-powershell-code/">參考文章連結</a></p>
</blockquote>
<p>此篇文章比較多在介紹 ClearFake 相關內容</p>
<h2 id="2024-07-02-EtherHiding-and-Fake-Updates-Used-to-Deliver-Malware"><a href="#2024-07-02-EtherHiding-and-Fake-Updates-Used-to-Deliver-Malware" class="headerlink" title="2024.07.02 - EtherHiding and Fake-Updates Used to Deliver Malware"></a>2024.07.02 - EtherHiding and Fake-Updates Used to Deliver Malware</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://wyretechnology.com/etherhiding-fake-updates-used-to-deliver-malware/">參考文章連結</a></p>
</blockquote>
<p>這一篇談論到，作者觀察最近有透過 <code>EtherHide</code> 傳播 Fake-Updates 惡意程式，並最終安裝了 <code>Lumma</code> 資料竊取惡意程式</p>
<p>攻擊流程:</p>
<ol>
<li>使用者瀏覽了受感染的網站 (wordpress)</li>
<li>網站執行攻擊者嵌入的惡意 javascript ，跳出虛假的更新 (Fake Updates) 軟體資訊 </li>
<li>點擊假更新資訊，會在背後執行 powershell 指令，之後下載一個惡意壓縮檔案並執行裡面的惡意程式</li>
</ol>
<h2 id="2024-02-02-Smargaft-Harnesses-EtherHiding-for-Stealthy-C2-Hosting"><a href="#2024-02-02-Smargaft-Harnesses-EtherHiding-for-Stealthy-C2-Hosting" class="headerlink" title="2024.02.02 - Smargaft Harnesses EtherHiding for Stealthy C2 Hosting"></a>2024.02.02 - Smargaft Harnesses EtherHiding for Stealthy C2 Hosting</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.xlab.qianxin.com/smargaft_abusing_binance-smart-contracts_en/">參考文章連結</a></p>
</blockquote>
<p>這一篇是說他們看到有惡意程式的 c2 是放在 BSC 智能鏈上面，但觀察到防毒廠商將這些惡意程式仍定義為 Mirai ，他們重新命名這些惡意程式為 Smargaft </p>
<p>這些惡意程式的主要功能是做 DDoS </p>
<p>xlab 表示這是他們第一次在殭屍網路上面看到使用 EtherHide 攻擊技術</p>
<p><img src="https://blog.xlab.qianxin.com/content/images/2024/01/smartgaft_brief.png" alt="image"><br>圖片取自：<a target="_blank" rel="noopener" href="https://blog.xlab.qianxin.com/smargaft_abusing_binance-smart-contracts_en/">XLAB Blog</a></p>
<p>Smargaft 惡意程式會透過 json rpc 和區塊鏈網路通訊，取得 c2 資訊</p>
<ul>
<li>獲取鏈上的資料，是使用幣安的 SDK 裡面的 <code>eth_call</code> 方法</li>
</ul>
<h2 id="2023-10-13-“EtherHiding”-—-Hiding-Web2-Malicious-Code-in-Web3-Smart-Contracts"><a href="#2023-10-13-“EtherHiding”-—-Hiding-Web2-Malicious-Code-in-Web3-Smart-Contracts" class="headerlink" title="2023.10.13 - “EtherHiding” — Hiding Web2 Malicious Code in Web3 Smart Contracts"></a>2023.10.13 - “EtherHiding” — Hiding Web2 Malicious Code in Web3 Smart Contracts</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/@guardiosecurity/etherhiding-hiding-web2-malicious-code-in-web3-smart-contracts-65ea78efad16">參考文章連結</a></p>
</blockquote>
<p>此篇文章被其他文章引用，被認為是<span style="color:#FF0000;">最早發現</span> <code>EtherHide</code> 的起始文章</p>
<p>文章提到的摘要整理</p>
<ol>
<li>觀察到 EtherHiding 是利用幣安的 BSC 智能合約來託管惡意程式</li>
<li>觀察到攻擊者入侵大量的 wordpress 網站來誤導使用者下載惡意虛假的「瀏覽器更新」檔案</li>
<li>此篇文章主要探討 ClearFake 攻擊活動</li>
</ol>
<h1 id="知識補充"><a href="#知識補充" class="headerlink" title="知識補充"></a>知識補充</h1><h2 id="什麼是-C2"><a href="#什麼是-C2" class="headerlink" title="什麼是 C2"></a>什麼是 C2</h2><p>攻擊者植入惡意程式到受害者電腦上，惡意程式會回連到攻擊者的機器</p>
<p>我們稱惡意程式連回去的攻擊者機器為 C2</p>
<h2 id="什麼是-ClearFake"><a href="#什麼是-ClearFake" class="headerlink" title="什麼是 ClearFake"></a>什麼是 ClearFake</h2><p>這是一種利用社交工程欺騙使用者執行惡意指令的方法</p>
<p>攻擊者會在受感染的網站 (常見於 wordpress) ，植入惡意的 javascript 程式碼 </p>
<p>並且當使用者瀏覽到受駭的網站時，會跳出一個虛假的更新內容，欺騙使用者點擊</p>
<p>一旦使用者被騙點擊相關資訊 (常見是要求你要更新檔案，才可完整瀏覽該網站或執行某些事情)</p>
<p>使用者就會執行攻擊者的惡意指令</p>
<h2 id="ClearFake-搭配-EtherHide-的意思"><a href="#ClearFake-搭配-EtherHide-的意思" class="headerlink" title="ClearFake 搭配 EtherHide 的意思"></a>ClearFake 搭配 EtherHide 的意思</h2><p>上述提及當使用者瀏覽到受駭的網站時，會跳出一個虛假的更新內容，欺騙使用者點擊</p>
<p>搭配 EtherHide 的意思就是使用者點擊惡意虛假內容時，會連接到 BSC 智能鏈上抓取攻擊者預先設置好的惡意指令</p>
<h2 id="什麼是-BSC"><a href="#什麼是-BSC" class="headerlink" title="什麼是 BSC"></a>什麼是 BSC</h2><p>BSC 是幣安於 2020 年上線的區塊鏈平台，類似以太坊，支援 DApp 和智能合約</p>
<h2 id="為何惡意程式愛用-eth-call"><a href="#為何惡意程式愛用-eth-call" class="headerlink" title="為何惡意程式愛用 eth_call"></a>為何惡意程式愛用 <code>eth_call</code></h2><p><code>eth_call</code> 是幣安的 SDK 提供的一個方法，可以讓使用者從智能合約中讀取資料，而<span style="color:#FF0000;">不會產生任何交易費用</span>，甚至不會有任何紀錄在區塊鏈上面</p>
<p>所以攻擊者可以使用 <code>eth_call</code> 這個方法來讓惡意程式從鏈上獲取資料</p>
<h1 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h1><p>[1]: <a target="_blank" rel="noopener" href="https://www.packetlabs.net/posts/etherhiding-a-new-tactic-for-hiding-malware-on-the-blockchain/">EtherHiding: Hiding Malware On the Blockchain</a><br>[2]: <a target="_blank" rel="noopener" href="https://medium.com/@guardiosecurity/etherhiding-hiding-web2-malicious-code-in-web3-smart-contracts-65ea78efad16">“EtherHiding” — Hiding Web2 Malicious Code in Web3 Smart Contracts</a><br>[3]: <a target="_blank" rel="noopener" href="https://docs.watchdata.io/blockchain-apis/binance-smart-chain-api/eth_call-bsc"> eth_call (BSC) </a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://qsweb3.com">QSWeb3</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://qsweb3.com/etherhide-blockchain-cnc/">https://qsweb3.com/etherhide-blockchain-cnc/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/BlockChain/">BlockChain</a><a class="post-meta__tags" href="/tags/Web3/">Web3</a><a class="post-meta__tags" href="/tags/EtherHide/">EtherHide</a><a class="post-meta__tags" href="/tags/c2/">c2</a><a class="post-meta__tags" href="/tags/BSC/">BSC</a></div><div class="post-share"><div class="social-share" data-image="https://raw.githubusercontent.com/qsweb3/post-cover-img/refs/heads/main/coverEtherHide.png" data-sites="facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/what-is-defi/" title="新手也能懂的 DeFi 世界：開啟數位金融自由之路"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">新手也能懂的 DeFi 世界：開啟數位金融自由之路</div></div><div class="info-2"><div class="info-item-1">什麼是 DeFi？「DeFi」（Decentralized Finance，去中心化金融）  利用區塊鏈與智能合約，讓金融服務在沒有銀行或中介機構的情況下自動運作的系統。  DeFi 是一個個廣義的概念，目標是複製傳統金融服務，但以去中心化的方式進行 具體為想要實現的特性為：  非託管（non-custodial） 開放（open） 透明（transparent） 無需許可（permissionless     特性 說明 傳統金融對比    非託管 使用者直接控制資產 銀行代為保管   開放 任何人都能使用 需通過審查與帳戶   透明 程式碼公開可審查 系統黑箱   無需許可 人人可開發應用 需取得執照與批准   這些特性讓 DeFi 成為真正的「開放的金融世界」 DeFi 與傳統金融的差別   項目 傳統金融（TradFi） 去中心化金融（DeFi）    資產保管 銀行或金融機構代管，用戶需信任機構。 使用者自己掌控資產，只要擁有私鑰即可操作。   交易審批 必須通過銀行或監管單位。 完全自動執行，無需第三方批准。   系統開發 封閉系統，外部開發者難以介入。 開放原始碼，...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/blockchain-51-attack-analysis/" title="解析：區塊鏈的 51% 攻擊"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-09</div><div class="info-item-2">解析：區塊鏈的 51% 攻擊</div></div><div class="info-2"><div class="info-item-1">簡介 51% 攻擊51% 攻擊就是當攻擊者控制了超過半數的算力，便可與主鏈分離，重寫交易紀錄、控制挖礦獎勵（僅讓其網絡內的機器獲得報酬），甚至進行雙重支付（double spending），即多次使用同一枚幣。 這種在大型加密貨幣（如比特幣（BTC）與以太坊（Ethereum）），犯罪組織幾乎不可能取得 51% 的挖礦控制權，但小型加密貨幣是有可能遭受此種攻擊 相關新聞2025.08.22 - 國際刑警組織抓獲大量犯罪分子新聞連結 這篇新聞講述的是國際刑警組織協調各國在非洲各地當局逮捕 1209 個犯罪者 此次行動稱為：Operation Serengeti 2.0 ，聯合 18 個國家來打擊網路犯罪者 這場行動中：  搗毀 25個加密貨幣挖礦中心 查獲了45座非法發電站 確認了6.5萬名受害者，損失金額估計達3億美元  下圖為搗毀的加密貨幣挖礦中心 取自: INTERPOL 根據此次所擁有的算力研判是有能力對小型加密貨幣進行 51 % 攻擊 </div></div></div></a><a class="pagination-related" href="/web3-dapp-decentralized-application/" title="Web3 基礎知識 - Dapp(Decentralized Application)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-10</div><div class="info-item-2">Web3 基礎知識 - Dapp(Decentralized Application)</div></div><div class="info-2"><div class="info-item-1">Dapp - 去中心化應用程式（Decentralized Applications） 代表程式存在並執行在 區塊鏈（blockchain）或點對點網路（P2P network, peer-to-peer） 上 也就是不是在單一電腦上運行，而是分散在一個由多台電腦組成的網路中。 這也意味著，它們不受任何單一權威機構的掌控。 傳統的程式比如 twitter ，是執行在特定的公司掌控的電腦上 這是兩種的差異 補充區塊鏈可以看成是一個可稽核的資料庫，但他只能新增不能刪除或修改資料 如果要更新資料，是把資料放在新的地址上 </div></div></div></a><a class="pagination-related" href="/web3-remix-smart-contract/" title="Web3 基礎知識 - REMIX &amp; 智能合約"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Web3 基礎知識 - REMIX &amp; 智能合約</div></div><div class="info-2"><div class="info-item-1">REMIXRemix(remix.ethereum.org) Remix 是一個 IDE，可以在這裡執行智能合約和寫 SODILITY 程式碼，本身也有一些 Plugin 可以設定合約並在測試網路上進行測試 可以幫助學習和理解去中心化概念 (虛擬貨幣和 Dapp) 下面的圖片就是連到 Remix 會看到的，左邊是預設的工作空間，裡面有一些資料夾 下面圈起來的是控制台（console）。這個控制台的作用是幫助我們，會顯示錯誤訊息，告訴我們程式碼哪裡有錯，也會在執行成功時顯示結果 中間就是我們一般寫程式的地方   預設 REMIX 會有一些範例的程式碼，就是下面圖的紅色圈起來，副檔案名稱是 .sol ，這就是 sodility 寫的程式碼 寫完可以編譯，之後部署合約，部署合約就是把合約交易發到區塊鏈上   簡介智能合約智慧合約本質上就是兩個人（或兩方）之間的一份協議 所謂的「智能」，就是：傳統上由第三方中介來執行與見證的角色，被電腦程式所取代 智慧合約的程式碼定義了協議雙方的條款與條件，只要合約被部署並執行，結果就會按照程式碼自動完成，不需要依賴銀行、律師或其他中間人。 這裡可以用 ...</div></div></div></a><a class="pagination-related" href="/web3-solidity-fundraising-project/" title="Web3 基礎知識 - Sodility 教學(2) - 透過小專案學習 (募資專案)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Web3 基礎知識 - Sodility 教學(2) - 透過小專案學習 (募資專案)</div></div><div class="info-2"><div class="info-item-1">學習目標透過一個簡單的專案程式碼，來學習 sodility ，這邊會先貼出整份程式碼，底下會個別解釋 sodility 的程式語言知識 專案募資合約簡介情境  有一個專案發起人，他發起一個募資專案，需要一筆目標金額 大家可以投資這個專案 (類似共同存錢到一個戶頭) 只有當募資成功（達到目標金額）時，這筆錢才會真正轉給專案發起人 如果募資失敗，投資的錢要能退還給各個投資人  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091// SPDX-License-Identifier: MITpragma solidity ^0.8.4;contract ProjectFunding &#123;    // --- 狀態變數 (State Variables) ---    // 先定義合約的狀態...</div></div></div></a><a class="pagination-related" href="/web3-solidity-intro-tutorial/" title="Web3 基礎知識 - Sodility 教學 (1)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-11</div><div class="info-item-2">Web3 基礎知識 - Sodility 教學 (1)</div></div><div class="info-2"><div class="info-item-1">簡介 sodility程式碼開頭用 1pragma solidity ^0.8.0;   pragma 是一個宣告語句，用來告訴編譯器這份程式碼所使用的 Solidity 版本 ^ 這個代表「這個版本以及之後的版本都可以」  其他範例 1pragma solidity &gt;=0.7.0 &lt;0.9.0;   這是代表適用的版本是包含 0.7.0 以上，且支援版本是 0.9.0 之下，但不包含有 0.9.0  回顧智能合約 - 簡介智能合約 (Smart Contract） 本質上是一組程式碼的集合，包含兩個東西：  函數 : 用來執行動作，例如存資料、取資料 資料 : 儲存在區塊鏈上的變數與資訊  當我們把智能合約部署（Deploy）到以太坊區塊鏈上，它就會被分配一個唯一的區塊鏈位址。 任何人都可以透過這個位址來與合約互動。 撰寫智能合約簡介變數這邊先上一個範例 123456789contract simpleTest &#123;		uint number = 123;	bool testGood = true;	string data = &quot;it is a ...</div></div></div></a><a class="pagination-related" href="/web3-solidity-tutorial-3/" title="Web3 基礎知識 - Sodility 教學 (3) - 創建自己的虛擬貨幣"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-12</div><div class="info-item-2">Web3 基礎知識 - Sodility 教學 (3) - 創建自己的虛擬貨幣</div></div><div class="info-2"><div class="info-item-1">簡介專案這是一個簡單版本的虛擬貨幣 功能：  只有作者 (owner) 才能發行新幣，其他人都不行 任何都可以銷毀自己錢包的虛擬貨幣 發行者可以把自己的虛擬貨幣轉給別人  完整程式碼透過 sodility 放置在 REMIX 做測試 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990// 指定 Solidity 編譯器版本pragma solidity ^0.8.18;// 定義我們的合約，取名為 MyNewTokencontract MyNewToken &#123;    // --- 狀態變數 (State Variables) ---    address public owner; // 紀錄合約的創建者 (擁有者)    uint256 public totalSupply; //...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar_img.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">QSWeb3</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/qsweb3"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">簡介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF-EtherHide"><span class="toc-number">1.1.</span> <span class="toc-text">什麼是 EtherHide</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EtherHide-%E5%A6%82%E4%BD%95%E9%81%8B%E4%BD%9C"><span class="toc-number">1.2.</span> <span class="toc-text">EtherHide 如何運作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CTF-%E7%AB%B6%E8%B3%BD"><span class="toc-number">2.</span> <span class="toc-text">CTF 競賽</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-07-13-%E8%B3%87%E5%AE%89%E8%8F%81%E8%8B%B1%E5%AF%A6%E6%88%B0%E5%9F%B9%E8%82%B2%E8%AA%B2%E7%A8%8B%EF%BC%8D%E7%AC%AC%E4%BA%8C%E6%9C%9F%E8%87%BA%E5%8C%97%E5%A0%B4-%E7%B6%B2%E8%B7%AF%E5%A8%81%E8%84%85%E9%98%B2%E7%A6%A6%E7%AB%B6%E8%B3%BD"><span class="toc-number">2.1.</span> <span class="toc-text">2025.07.13 - 資安菁英實戰培育課程－第二期臺北場: 網路威脅防禦競賽</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%8C%E7%9B%AE%E7%B0%A1%E4%BB%8B"><span class="toc-number">2.1.1.</span> <span class="toc-text">題目簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A1%8C%E5%88%86%E4%BA%AB"><span class="toc-number">2.1.2.</span> <span class="toc-text">解題分享</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%BE%E5%B0%8B%E6%83%A1%E6%84%8F%E7%A8%8B%E5%BC%8F%E5%9C%A8%E5%93%AA"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">找尋惡意程式在哪</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E6%83%A1%E6%84%8F%E7%A8%8B%E5%BC%8F"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">分析惡意程式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hackcon2018-CTF-EtherHide"><span class="toc-number">2.2.</span> <span class="toc-text">Hackcon2018 CTF - EtherHide</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%8C%E7%9B%AE%E7%B0%A1%E4%BB%8B-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">題目簡介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A1%8C%E5%88%86%E4%BA%AB-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">解題分享</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B6%B2%E8%B7%AF%E6%96%87%E7%AB%A0%E5%BD%99%E6%95%B4%E6%95%B4%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">網路文章彙整整理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-10-01-Investigating-a-ClearFake-ClickFix-Etherhide-campaign"><span class="toc-number">3.1.</span> <span class="toc-text">2025.10.01 - Investigating a ClearFake&#x2F;ClickFix + Etherhide campaign</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-04-22-Detecting-Fake-CAPTCHA-Campaigns-ClickFix-ClearFake-and-Etherhide"><span class="toc-number">3.2.</span> <span class="toc-text">2025.04.22 - Detecting Fake CAPTCHA Campaigns: ClickFix, ClearFake, and Etherhide</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-01-02-EtherHiding-and-ClickFix-new-mask-of-social-engineering-campaign"><span class="toc-number">3.3.</span> <span class="toc-text">2025.01.02 - EtherHiding and ClickFix: new mask of social engineering campaign</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-12-05-ClearFake-Campaigns-Trick-Users-Into-Copying-and-Executing-Powershell-Code"><span class="toc-number">3.4.</span> <span class="toc-text">2024.12.05 - ClearFake Campaigns Trick Users Into Copying and Executing Powershell Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-07-02-EtherHiding-and-Fake-Updates-Used-to-Deliver-Malware"><span class="toc-number">3.5.</span> <span class="toc-text">2024.07.02 - EtherHiding and Fake-Updates Used to Deliver Malware</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-02-02-Smargaft-Harnesses-EtherHiding-for-Stealthy-C2-Hosting"><span class="toc-number">3.6.</span> <span class="toc-text">2024.02.02 - Smargaft Harnesses EtherHiding for Stealthy C2 Hosting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2023-10-13-%E2%80%9CEtherHiding%E2%80%9D-%E2%80%94-Hiding-Web2-Malicious-Code-in-Web3-Smart-Contracts"><span class="toc-number">3.7.</span> <span class="toc-text">2023.10.13 - “EtherHiding” — Hiding Web2 Malicious Code in Web3 Smart Contracts</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9F%A5%E8%AD%98%E8%A3%9C%E5%85%85"><span class="toc-number">4.</span> <span class="toc-text">知識補充</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF-C2"><span class="toc-number">4.1.</span> <span class="toc-text">什麼是 C2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF-ClearFake"><span class="toc-number">4.2.</span> <span class="toc-text">什麼是 ClearFake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ClearFake-%E6%90%AD%E9%85%8D-EtherHide-%E7%9A%84%E6%84%8F%E6%80%9D"><span class="toc-number">4.3.</span> <span class="toc-text">ClearFake 搭配 EtherHide 的意思</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF-BSC"><span class="toc-number">4.4.</span> <span class="toc-text">什麼是 BSC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%BA%E4%BD%95%E6%83%A1%E6%84%8F%E7%A8%8B%E5%BC%8F%E6%84%9B%E7%94%A8-eth-call"><span class="toc-number">4.5.</span> <span class="toc-text">為何惡意程式愛用 eth_call</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%83%E8%80%83%E8%B3%87%E6%96%99"><span class="toc-number">5.</span> <span class="toc-text">參考資料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/etherhide-blockchain-cnc/" title="Etherhide Explained: The Rise of Blockchain-Based Command and Control"><img src="https://raw.githubusercontent.com/qsweb3/post-cover-img/refs/heads/main/coverEtherHide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Etherhide Explained: The Rise of Blockchain-Based Command and Control"/></a><div class="content"><a class="title" href="/etherhide-blockchain-cnc/" title="Etherhide Explained: The Rise of Blockchain-Based Command and Control">Etherhide Explained: The Rise of Blockchain-Based Command and Control</a><time datetime="2025-10-16T09:31:29.000Z" title="Created 2025-10-16 09:31:29">2025-10-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/what-is-defi/" title="新手也能懂的 DeFi 世界：開啟數位金融自由之路">新手也能懂的 DeFi 世界：開啟數位金融自由之路</a><time datetime="2025-10-09T11:28:29.000Z" title="Created 2025-10-09 11:28:29">2025-10-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/blockchain-51-attack-analysis/" title="解析：區塊鏈的 51% 攻擊">解析：區塊鏈的 51% 攻擊</a><time datetime="2025-10-09T09:42:44.000Z" title="Created 2025-10-09 09:42:44">2025-10-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/ida-pro-plugins/" title="[逆向分析] IDA Pro Plugin 使用心得分享">[逆向分析] IDA Pro Plugin 使用心得分享</a><time datetime="2025-09-24T11:42:35.000Z" title="Created 2025-09-24 11:42:35">2025-09-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/x64dbg-plugin-for-malware-analysis/" title="[逆向分析] x64dbg plugin 使用 &amp; 心得">[逆向分析] x64dbg plugin 使用 &amp; 心得</a><time datetime="2025-09-23T09:27:21.000Z" title="Created 2025-09-23 09:27:21">2025-09-23</time></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(to top, rgb(3, 3, 18), rgb(10, 26, 51), rgb(18, 8, 36));;"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By QSWeb3</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.0</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>